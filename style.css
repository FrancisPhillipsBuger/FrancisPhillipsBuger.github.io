/*
 * Custom styles for Francis’ personal page.
 *
 * The layout and many of the dark‑mode interactions take inspiration
 * from Jeannette Bohg’s personal website and Cassidy Williams’ template.
 */

html, body {
  width: 100%;
  margin: 0;
  padding: 0;
  font-family: "Roboto Mono", monospace;
  background: #fff;
  color: #000;
  /* Ensure the body always covers at least the full viewport height so that the
     background color extends to the bottom of the page.  Without this, short
     pages in dark mode expose the html element's white background at the
     bottom of the viewport. */
  min-height: 100vh;
}

:root {
  --safe-top: env(safe-area-inset-top);
  --safe-right: env(safe-area-inset-right);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
}

/* Always honor the HTML `hidden` attribute, even if later rules set display. */
[hidden] { display: none !important; }

/* Dark mode applies when the <body> element has the class 'dark-mode'. */
body.dark-mode {
  background: #000;
  color: #fff;
}

/* Apply the dark mode background and foreground colours to the <html> element when
   it has the dark-mode class.  This ensures that areas outside of the body (for
   example, when the content is shorter than the viewport height) still have the
   correct dark background instead of reverting to the default white canvas. */
html.dark-mode {
  background: #000;
  color: #fff;
}

/* Universal selection highlight. */
::selection {
  background-color: #eb4888;
  color: #000;
}

button {
  /* Pill shaped toggle buttons inspired by Jeannette Bohg’s original design. */
  display: inline-block;
  min-width: 72px;
  height: 32px;
  padding: 2px 14px;
  border: 2px solid #96979c;
  border-radius: 22px;
  box-sizing: border-box;
  color: #96979c;
  font-size: 0.9rem;
  font-family: inherit;
  background: transparent;
  transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
  cursor: pointer;
}

button:hover {
  /* Subtle hover effect: light grey on light mode, semi‑transparent on dark mode. */
  background: rgba(150, 151, 156, 0.1);
}

/* Highlight the active button.  In light mode, active buttons have a white interior with
   coloured text and border.  In dark mode the interior uses a semi‑transparent tint. */
button.active {
  border-color: #eb4888;
  color: #eb4888;
  background-color: #fff;
}

body.dark-mode button.active {
  background-color: rgba(235, 72, 136, 0.15);
}

/* Dark‑mode adjustments for buttons: more contrast for default state. */
body.dark-mode button {
  border-color: #777;
  color: #aaa;
  background: transparent;
}

body.dark-mode button:hover {
  background: rgba(255, 255, 255, 0.08);
}

.container {
  /* Use padding instead of top margin so that the body's background colour remains visible in dark mode.
     A top margin on the first child can collapse with the body's margin and reveal the html's default
     background (white) as a bar at the top of the page.  By using padding we avoid that collapse. */
  margin: 0 auto;
  padding: calc(50px + var(--safe-top, 0px)) max(5px, var(--safe-right, 0px)) calc(32px + var(--safe-bottom, 0px)) max(5px, var(--safe-left, 0px));
  max-width: 800px;
}

@media (max-width: 600px) {
  .container {
    /* Add top padding on small screens as well to prevent margin collapse. */
    padding: calc(40px + var(--safe-top, 0px)) max(20px, var(--safe-right, 0px)) calc(28px + var(--safe-bottom, 0px)) max(20px, var(--safe-left, 0px));
  }
}

.header-section {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
}

/* Improve header layout on tablets */
@media (max-width: 800px) {
  .header-section {
    gap: 14px;
  }
  .header-frame {
    max-width: 100%;
  }
  .img-frame {
    margin-left: auto;
    margin-right: auto;
  }
}

.header-frame {
  /* Allow more room for the name and subtitle text */
  max-width: 470px;
}

h1 {
  font-weight: 400;
  margin: 0;
  font-size: clamp(1.8rem, 2.2rem + 0.5vw, 2.6rem);
}

/* Name styling: primary larger, secondary slightly smaller */
.name-primary {
  display: block;
  line-height: 1.1;
}

.name-secondary {
  display: block;
  line-height: 1.1;
  font-size: 0.7em; /* slightly smaller than primary */
  margin-top: 0.15em;
}

/* Typewriter caret for auto-switching name */
.typewriter {
  position: relative;
}
.typewriter::after {
  content: "";
  display: inline-block;
  width: 0.6ch;
  height: 1em;
  margin-left: 0.1ch;
  vertical-align: -0.15em;
  background: currentColor;
  opacity: 0.7;
  animation: caretBlink 1s steps(1, end) infinite;
}

@keyframes caretBlink {
  0%, 50% { opacity: 0.7; }
  51%, 100% { opacity: 0; }
}

@media (prefers-reduced-motion: reduce) {
  .typewriter::after {
    animation: none;
  }
}

h2 {
  color: #96979c;
  font-weight: 300;
  margin: 0.4em 0 0;
  font-size: clamp(1rem, 1rem + 0.2vw, 1.15rem);
}

.img-frame {
  position: relative;
  width: min(260px, 42vw);
  height: min(260px, 42vw);
  margin: 10px 0;
  border-radius: 50%;
  overflow: hidden;
  background: #f8f9fb; /* Fallback background */
  display: flex;
  align-items: center;
  justify-content: center;
}

.img-frame img {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
}

.links {
  margin: 25px 0;
}

.links a {
  /* Animated underline effect similar to cassidoo.co */
  position: relative;
  display: inline-block;
  margin-right: 16px;
  color: #96979c; /* individual links override this via inline color */
  font-size: 0.9rem;
  text-decoration: none; /* we'll draw our own underline */
  padding-bottom: 2px; /* space for underline bar */
}

.links a::after {
  content: "";
  position: absolute;
  left: 0;
  bottom: -3px;
  height: 4px;
  width: 100%;
  background-color: currentColor; /* match the link color */
  border-radius: 2px;
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 200ms ease-in-out;
}

.links a:hover::after,
.links a:focus-visible::after,
.links a.active::after {
  transform: scaleX(1);
}

/* Reusable animated underline for inline links in content
   Works across multi-line wrapped text */
.animated-link {
  text-decoration: none;
  background-image: linear-gradient(currentColor, currentColor);
  background-repeat: no-repeat;
  background-position: 0 100%;
  background-size: 0% 4px;
  transition: background-size 200ms ease-in-out;
}
.animated-link:hover,
.animated-link:focus-visible,
.animated-link.active {
  background-size: 100% 4px;
}

@media (max-width: 600px) {
  .links {
    text-align: center;
  }
  .links a {
    display: inline-block;
    margin: 6px 10px;
  }
}

/* Toggle button group */
.toggler {
  margin: 25px 0;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center; /* vertically align label with buttons */
}

.toggler button {
  flex: 0 0 auto; /* prevent stretching; keep natural width */
  min-width: 60px;
}

/* Ensure the "Bio:" label aligns with the buttons and has no extra margins */
.toggler p {
  margin: 0;
}

@media (max-width: 600px) {
  .toggler {
    justify-content: center;
  }
}

/* Bio sections hidden by default except the one with .show */
.bio {
  display: none;
  line-height: 1.6;
  font-size: 0.95rem;
}

.bio.show {
  display: block;
}

/* About list (two-column rows with subtle dividers) */
.about-list {
  display: grid;
  grid-template-columns: 1fr; /* rows stack; each row is its own grid */
  border-top: 2px solid #eaeaea;
  margin-top: 12px;
}

.about-row {
  display: grid;
  grid-template-columns: 160px 1fr;
  gap: 18px;
  padding: 14px 0;
  border-bottom: 2px solid #eaeaea;
  align-items: start;
}

.about-label {
  color: #96979c;
  font-size: 0.9rem;
  line-height: 1.6;
}

.about-content {
  color: #111;
  line-height: 1.9;
}

@media (max-width: 560px) {
  .about-row {
    grid-template-columns: 1fr; /* stack label on top on small screens */
    gap: 6px;
  }
}

/* Dark mode for about list */
body.dark-mode .about-list {
  border-top-color: #222;
}

body.dark-mode .about-row {
  border-bottom-color: #222;
}

body.dark-mode .about-label {
  color: #bbb;
}

body.dark-mode .about-content {
  color: #ddd;
}

/* List style for projects */
.bio ul {
  list-style-type: disc;
  padding-left: 20px;
}

.bio li {
  margin-bottom: 6px;
}

/* Research list styling */
.research-intro {
  color: #96979c;
  font-size: 0.9rem;
  margin-bottom: 10px;
}

.research-list {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  list-style: none;
  padding: 0;
  margin: 0;
}

.research-item {
  padding: 6px 12px;
  border: 1px solid #d0d0d0;
  border-radius: 999px;
  background: #fff;
  color: #333;
  font-size: 0.9rem;
  cursor: pointer;
  transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.05s ease;
}

.research-item:hover,
.research-item:focus-visible {
  border-color: #eb4888;
  color: #eb4888;
}

.research-item.selected {
  background: rgba(235, 72, 136, 0.12);
  border-color: #eb4888;
  color: #eb4888;
}

.research-item:active {
  transform: scale(0.98);
}

.research-sep {
  display: block;
  width: 100%;
  margin: 6px 0 0;
  color: #96979c;
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

/* Dark mode for research list */
body.dark-mode .research-item {
  background: #111;
  color: #ddd;
  border-color: #444;
}

body.dark-mode .research-item:hover,
body.dark-mode .research-item:focus-visible {
  color: #eb4888;
  border-color: #eb4888;
}

body.dark-mode .research-item.selected {
  background: rgba(235, 72, 136, 0.18);
  border-color: #eb4888;
  color: #eb4888;
}

/* Table styling for skills */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  font-size: 0.85rem;
}

th, td {
  border: 1px solid #d0d0d0;
  padding: 8px 12px;
  text-align: left;
}

th {
  background-color: #f5f5f5;
  color: #333;
}

/* Dark mode table adjustments */
body.dark-mode th {
  background-color: #222;
  color: #eee;
}
body.dark-mode td,
body.dark-mode th {
  border-color: #444;
}
body.dark-mode table {
  color: #ddd;
}

/* Citation markers appear inline and small.  Apply to any element with the 'citation' class (e.g. <a>, <span>). */
.citation {
  font-size: 0.75rem;
  vertical-align: super;
  text-decoration: none;
  cursor: default;
  color: inherit;
}

.citation:hover {
  text-decoration: underline;
}

/* Dark mode toggler positioning */
.dark-mode-toggler {
  position: fixed;
  top: 10px;
  right: 10px;
}

.dark-mode-toggler input[type="checkbox"] {
  display: none;
}

.dark-mode-toggler input[type="checkbox"] + label::before {
  content: "";
  display: block;
  height: 26px;
  width: 60px;
  background: #fff;
  border: 2px solid #96979c;
  border-radius: 15px;
  position: absolute;
  top: 0;
  left: -65px;
  transition: background 0.4s ease;
}

.dark-mode-toggler input[type="checkbox"] + label::after {
  content: "";
  display: block;
  height: 20px;
  width: 20px;
  background: #96979c;
  border: 2px solid #fff;
  border-radius: 50%;
  position: absolute;
  top: 3px;
  left: -62px;
  transition: left 0.4s ease, background 0.4s ease;
}

.dark-mode-toggler input[type="checkbox"]:checked + label::before {
  background: #000;
  border: 2px solid #fff;
}

.dark-mode-toggler input[type="checkbox"]:checked + label::after {
  left: -28px;
  /* When dark mode is enabled the knob uses the accent color so it remains visible on a dark background. */
  background: #eb4888;
  border: 2px solid #fff;
}

/* Additional styling for dark mode toggle in dark mode: adjust the track and knob colours for better contrast. */
body.dark-mode .dark-mode-toggler input[type="checkbox"] + label::before {
  background: #222;
  border-color: #888;
}

body.dark-mode .dark-mode-toggler input[type="checkbox"] + label::after {
  background: #888;
  border-color: #222;
}

body.dark-mode .dark-mode-toggler input[type="checkbox"]:checked + label::after {
  background: #eb4888;
  border-color: #eb4888;
}

/* Attribution styling */
.attribution {
  /* Align with the main container width and horizontal padding */
  margin: 24px auto 24px;
  max-width: 800px;
  padding: 0 max(5px, var(--safe-right, 0px)) 0 max(5px, var(--safe-left, 0px));
  font-size: 0.85rem;
  color: #96979c;
  line-height: 1.6;
}

body.dark-mode .attribution {
  color: #777;
}

/* Dark mode for image frame */
body.dark-mode .img-frame {
  background: #1a1a1a;
}

/* Skills cards horizontal scroller */
.skills-cards {
  display: flex;
  gap: 18px;
  margin-top: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  padding: 6px 6px 16px;
  scroll-padding: 6px;
  border-radius: 14px;
  position: relative;
  background: transparent;
}

.skill-card {
  background: #fff;
  border: 1px solid #eee;
  border-radius: 16px;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.06);
  padding: 22px;
  flex: 0 0 auto;
  width: clamp(260px, 44vw, 360px);
  scroll-snap-align: start;
}

.skill-icon {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: rgba(255, 165, 0, 0.12);
  color: #ff9900;
  display: grid;
  place-items: center;
  font-size: 22px;
  margin-bottom: 12px;
  border: 1px solid rgba(0, 0, 0, 0.04);
}

.skill-title {
  margin: 0 0 6px 0;
  font-size: 1.15rem;
  font-weight: 600;
  color: #111;
}

.skill-desc {
  margin: 0;
  color: #4a4b50;
  font-size: 0.95rem;
  line-height: 1.7;
}

/* Dark mode support for skills cards */
body.dark-mode .skill-card {
  background: #111;
  border-color: #333;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
}

body.dark-mode .skill-title {
  color: #fff;
}

body.dark-mode .skill-desc {
  color: #d0d0d0;
}

body.dark-mode .skill-icon {
  background: rgba(255, 165, 0, 0.2);
  color: #ffb84d;
  border-color: rgba(255, 255, 255, 0.08);
}

/* Subtle horizontal scrollbar styling (WebKit) */
.skills-cards::-webkit-scrollbar {
  height: 8px;
}

.skills-cards::-webkit-scrollbar-track {
  background: transparent;
  border-radius: 999px;
}

.skills-cards::-webkit-scrollbar-thumb {
  background: rgba(150, 150, 155, 0.3);
  border-radius: 999px;
}

body.dark-mode .skills-cards::-webkit-scrollbar-track {
  background: transparent;
}

body.dark-mode .skills-cards::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.28);
}

/* Edge fade masks for slide-in/out feeling */
.skills-cards::before,
.skills-cards::after {
  content: "";
  position: sticky;
  top: 0;
  width: 56px;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

.skills-cards::before {
  left: 0;
  background: linear-gradient(
    to right,
    #fff 0%,
    rgba(255, 255, 255, 0.85) 35%,
    rgba(255, 255, 255, 0) 100%
  );
}

.skills-cards::after {
  right: 0;
  background: linear-gradient(
    to left,
    #fff 0%,
    rgba(255, 255, 255, 0.85) 35%,
    rgba(255, 255, 255, 0) 100%
  );
}

body.dark-mode .skills-cards::before {
  background: linear-gradient(
    to right,
    #000 0%,
    rgba(0, 0, 0, 0.75) 35%,
    rgba(0, 0, 0, 0) 100%
  );
}

body.dark-mode .skills-cards::after {
  background: linear-gradient(
    to left,
    #000 0%,
    rgba(0, 0, 0, 0.75) 35%,
    rgba(0, 0, 0, 0) 100%
  );
}

/* Research section (modeled after Jon Barron’s compact card list) */
.research-section {
  margin: 24px 0 16px;
  padding-top: 0;
  border-top: none;
}

.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.section-title {
  margin: 0 0 6px 0;
  font-size: 1.6rem;
  font-weight: 500;
  color: #000; /* ensure pure black in light mode */
}

/* News section */
.news-section {
  margin: 20px 0 8px;
}

.news-header { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
.news-toggle {
  border: 1px solid #e0e0e0; background: #fff; color: #444; border-radius: 999px;
  padding: 4px 10px; font-size: 0.85rem; cursor: pointer;
}
body.dark-mode .news-toggle { background: #0f0f10; color: #ddd; border-color: #333; }

.news-card {
  border: 1.5px solid #e6e6e6;
  border-radius: 10px;
  padding: 14px 18px;
}

.news-list { list-style: none; margin: 0; padding: 0; display: grid; gap: 18px; }
.news-item { display: grid; grid-template-columns: 130px 1fr; gap: 16px; align-items: start; }
.news-date { font-weight: 700; color: #111; }
.news-text { color: #222; line-height: 1.8; }

@media (max-width: 560px) { .news-item { grid-template-columns: 1fr; gap: 6px; } }

body.dark-mode .news-card { border-color: #333; }
body.dark-mode .news-date { color: #fff; }
body.dark-mode .news-text { color: #ddd; }

/* collapsed state: only show first 4 items */
.news-card.collapsed .news-list > li:nth-child(n+4) { display: none; }

.section-subtitle {
  margin: 0 0 18px 0;
  color: #96979c;
  font-size: 0.95rem;
}

.research-lists {
  display: grid;
  grid-template-columns: 1fr;
  gap: 28px; /* vertical space between cards */
}

/* Make inner lists not generate their own boxes so items participate in the same grid */
.research-lists > .papers,
.research-lists > .projects {
  display: contents;
}

/* No extra media-rule needed because the unified grid is 1 column */

.paper {
  display: grid;
  grid-template-columns: 160px 1fr;
  gap: 16px;
  align-items: start;
  padding: 14px;
  border: 1px solid #eee;
  border-radius: 14px;
  background: #fff;
}

.paper-thumb {
  width: 160px;
  height: 100px;
  border-radius: 10px;
  overflow: hidden;
  background: #f6f6f6;
  display: grid;
  place-items: center;
  color: #999;
  font-size: 0.85rem;
  padding: 15px; /* add safe inset to avoid visual clipping at edges */
  box-sizing: border-box;
}

/* Ensure thumbnails are fully visible without cropping */
.paper-thumb img {
  width: 100%;
  height: 100%;
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  object-position: center;
  border: 0;
  display: block;
  margin: 0 auto;
}

/* Stack research card thumbnail above text on narrow screens */
@media (max-width: 560px) {
  .paper {
    grid-template-columns: 1fr;
  }
  .paper-thumb {
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;
    min-height: 120px; /* Ensure minimum height for proper display */
  }
  .paper-thumb img {
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
  }
}

.thumb-placeholder {
  padding: 6px 8px;
}

.paper-title {
  margin: 0 0 4px 0;
  font-size: 1.05rem;
  color: rgb(255, 165, 0);
}

.paper-authors,
.paper-venue,
.paper-links,
.paper-abstract {
  margin: 4px 0;
  color: #4a4b50;
}

/* Ensure primary author name stands out */
.paper-authors strong {
  font-weight: 700;
  color: rgb(0, 153, 220)
}

.paper-links a {
  color: rgb(0, 153, 220);
  text-decoration: none;
}

.paper-links a:hover {
  text-decoration: underline;
}

/* Dark mode for research section */
body.dark-mode .paper {
  background: #111;
  border-color: #333;
}

/* In dark mode, make section titles white for proper contrast */
body.dark-mode .section-title {
  color: #fff;
}

body.dark-mode .paper-thumb {
  background: #1a1a1a;
  color: #aaa;
}

body.dark-mode .paper-authors,
body.dark-mode .paper-venue,
body.dark-mode .paper-links,
body.dark-mode .paper-abstract {
  color: #d0d0d0;
}

body.dark-mode .paper-authors strong {
  color: #fff;
}

/* Research filter menu (years/tags/type) inspired by cassidoo.co/blog */
.research-menu {
  margin: 20px 0 14px;
  padding: 6px 8px;
  background: #f8f9fb; /* subtle panel background for separation */
  border: 1px solid #eee;
  border-radius: 10px;
}

/* Simple row for the filter enable switch */
.filter-toggle {
  margin: 0 0 6px;
  color: #96979c;
  font-size: 0.9rem;
}

/* Switch control */
.switch {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  user-select: none;
}

.switch input[type="checkbox"] {
  display: none;
}

.switch .switch-ui {
  position: relative;
  display: inline-block;
  width: 34px;
  height: 18px;
  background: #e9e9ee;
  border: 2px solid #c4c5cb;
  border-radius: 999px;
  transition: background-color 160ms ease, border-color 160ms ease;
}

.switch .switch-ui::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 2px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: #bdbec4;
  transform: translate(0, -50%);
  transition: transform 180ms cubic-bezier(0.2, 0, 0, 1), background-color 160ms ease;
}

.switch input[type="checkbox"]:checked + .switch-ui {
  background: rgba(235, 72, 136, 0.28);
  border-color: #eb4888;
}

.switch input[type="checkbox"]:checked + .switch-ui::after {
  transform: translate(16px, -50%);
  background: #eb4888;
}

.switch .switch-text {
  color: #96979c;
}

body.dark-mode .switch .switch-ui {
  background: #222;
  border-color: #555;
}

body.dark-mode .switch .switch-ui::after {
  background: #777;
}

body.dark-mode .switch input[type="checkbox"]:checked + .switch-ui {
  background: #eb4888;
  border-color: #eb4888;
}

body.dark-mode .switch input[type="checkbox"]:checked + .switch-ui::after {
  background: #111;
}

.switch .switch-ui:focus-visible {
  outline: 2px solid #0099dc;
  outline-offset: 2px;
}

@media (max-width: 600px) {
  .section-header {
    align-items: flex-end;
  }
  .filter-toggle {
    margin-bottom: 10px;
  }
}

.menu-divider {
  border: none;
  border-top: 2px solid #e6e6e6;
  margin: 6px 0;
}

.menu-row {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  line-height: 0.2; /* tighter row spacing */
}

.menu-item,
.menu-row a {
  position: relative;
  color: #111;
  text-decoration: none;
  font-size: 0.8rem; /* smaller text */
  line-height: 0.2; /* tighter line height on items */
}

.menu-item::after,
.menu-row a::after {
  content: "";
  position: absolute;
  left: 0;
  bottom: -2px;
  height: 2px;
  width: 100%;
  background: currentColor;
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 180ms ease-in-out;
}

.menu-item:hover::after,
.menu-item.active::after,
.menu-row a:hover::after,
.menu-row a.active::after {
  transform: scaleX(1);
}

.menu-item {
  background: transparent;
  border: none;
  padding: 0;
  cursor: pointer;
}

/* Color accents similar to Cassidy's tags: rotate colors with nth-child */
.menu-row.years .menu-item:nth-child(4n+1),
.menu-row.tags .menu-item:nth-child(4n+1),
.menu-row a:nth-child(4n+1) { color: #eac15a; }

.menu-row.years .menu-item:nth-child(4n+2),
.menu-row.tags .menu-item:nth-child(4n+2),
.menu-row a:nth-child(4n+2) { color: #74c7ec; }

.menu-row.years .menu-item:nth-child(4n+3),
.menu-row.tags .menu-item:nth-child(4n+3),
.menu-row a:nth-child(4n+3) { color: #f08ca0; }

.menu-row.years .menu-item:nth-child(4n+4),
.menu-row.tags .menu-item:nth-child(4n+4),
.menu-row a:nth-child(4n+4) { color: #66d19e; }

/* Dark mode tweaks */
body.dark-mode .menu-divider { border-top-color: #333; }
body.dark-mode .menu-item, body.dark-mode .menu-row a { color: #ddd; }
body.dark-mode .research-menu {
  background: #0f0f10;
  border-color: #222;
}

/* Snackbar (bottom slide-up card) */
.snackbar {
  position: fixed;
  left: 50%;
  bottom: -80px; /* hidden below viewport initially */
  transform: translateX(-50%);
  background: #111;
  color: #fff;
  padding: 12px 18px;
  border-radius: 10px;
  border: 1px solid #333;
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  transition: bottom 300ms ease, opacity 300ms ease;
  opacity: 0;
  z-index: 9999;
}

body.dark-mode .snackbar {
  background: #222;
  border-color: #555;
  color: #fff;
}

.snackbar.show {
  bottom: 24px; /* visible position */
  opacity: 1;
}

/* Ensure page doesn't have large empty space below last element in light/dark modes */
/* Remove explicit height and pseudo-footer to prevent extra scroll space. */

/* --- Research hero (AuraFusion-like) for project pages --- */
.research-hero {
  margin: 38px 0 18px;
  text-align: center;
}

.hero-brand {
  margin: 0 0 6px 0;
  font-size: clamp(1.4rem, 1.1rem + 1.3vw, 1.8rem);
  font-weight: 700;
  letter-spacing: 0.5px;
  line-height: 1.1;
  background: linear-gradient(90deg, #ff8a00 0%, #ffb84d 45%, #ff5e62 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  /* Glow */
  text-shadow: 0 0 8px rgba(255, 138, 0, 0.35), 0 0 16px rgba(255, 94, 98, 0.25);
  filter: drop-shadow(0 0 6px rgba(255, 138, 0, 0.18));
}

.hero-title {
  margin: 6px 0 10px;
  font-size: clamp(1.3rem, 1.1rem + 1vw, 1.6rem);
  line-height: 1.5;
  font-weight: 600;
  color: #222;
}

body.dark-mode .hero-title { color: #eee; }

.hero-venue {
  font-size: clamp(0.9rem, 0.85rem + 0.5vw, 1.1rem);
  margin: 6px 0 8px;
  font-weight: 600;
}

.hero-authors {
  margin: 8px auto 4px;
  max-width: 1000px;
  line-height: 1.8;
  font-size: clamp(0.9rem, 0.85rem + 0.5vw, 1.1rem);
}

.hero-authors a {
  color: rgb(0, 153, 220);
  text-decoration: none;
}

/* Bold highlight for the main author linking to home */
.hero-authors a[href="index.html"] {
  font-weight: 700;
}

.hero-authors a:hover { text-decoration: underline; }

.hero-affiliations {
  margin: 2px 0 14px;
  color: #96979c;
  font-size: 0.95rem;
}

.hero-actions {
  margin: 8px 0 18px;
  display: flex;
  justify-content: center;
  gap: 8px;
  flex-wrap: wrap;
}

.hero-actions .action {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 5px 9px;
  border-radius: 999px;
  border: 1px solid #3b3c3f;
  background: linear-gradient(180deg, #353637 0%, #2f3032 100%);
  color: #fff !important;
  -webkit-text-fill-color: #fff;
  font-size: 0.8rem;
  font-weight: 500;
  letter-spacing: 0.01em;
  text-decoration: none;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.06), 0 1px 2px rgba(0, 0, 0, 0.2);
  transition: background-color 160ms ease, border-color 160ms ease, transform 80ms ease, box-shadow 160ms ease;
}

.hero-actions .action:link,
.hero-actions .action:visited { color: #fff !important; -webkit-text-fill-color: #fff; }

.hero-actions .action:hover {
  background: linear-gradient(180deg, #3f4043 0%, #37383b 100%);
  border-color: #4a4c50;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), 0 2px 6px rgba(0,0,0,0.28);
}

.hero-actions .action:active { transform: translateY(1px); }

.hero-actions .action:focus-visible {
  outline: 2px solid #74c7ec;
  outline-offset: 2px;
}

.action .emoji { font-size: 0.95rem; opacity: 0.95; }
/* SVG icon style for Nerfies-like buttons */
.action .icon { width: 16px; height: 16px; fill: currentColor; display: inline-block; opacity: 0.95; }
/* Raster/SVG image icon support */
.action .icon-img { width: 16px; height: 16px; display: inline-block; object-fit: contain; vertical-align: middle; }
/* Force white for monochrome black icons (e.g., GitHub, arXiv) */
.action .icon-img.white { filter: brightness(0) invert(1); }

/* Accent variations: keep text white; tint only the leading icon */
.hero-actions .action.is-blue,
.hero-actions .action.is-green,
.hero-actions .action.is-orange,
.hero-actions .action.is-purple { color: inherit; }

.hero-actions .action.is-blue .emoji { color: #7ab8ff; }
.hero-actions .action.is-green .emoji { color: #66d19e; }
.hero-actions .action.is-orange .emoji { color: #ffb84d; }
.hero-actions .action.is-purple .emoji { color: #b18cff; }

/* Dark mode variants */
body.dark-mode .hero-authors a { color: #7ab8ff; }
body.dark-mode .hero-affiliations { color: #aaa; }
body.dark-mode .hero-actions .action {
  background: #2f3032;
  border-color: #2a2a2c;
  color: #fff;
}
body.dark-mode .hero-actions .action:hover {
  background: #38393b;
  border-color: #3a3a3d;
}

/* Reset generic image borders and ensure proper display */
img { 
  border: 0; 
  max-width: 100%;
  height: auto;
  vertical-align: middle;
}

/* Prevent image overflow in containers */
.container img {
  max-width: 100%;
  height: auto;
}

/* Ensure SVG images scale properly */
svg {
  max-width: 100%;
  height: auto;
}

/* --- Image fit utilities --- */
/* Use on any image: <img class="img-fit-contain"> so it scales to fit the box without cropping */
.img-fit-contain { width: 100%; height: 100%; object-fit: contain; object-position: center; }
/* Use on any image: <img class="img-fit-cover"> so it fills the box and crops overflow if needed */
.img-fit-cover { width: 100%; height: 100%; object-fit: cover; object-position: center; }

/* Optional helper for fixed-ratio boxes around images */
.aspect-16-9 { aspect-ratio: 16 / 9; }
.aspect-4-3  { aspect-ratio: 4 / 3; }
.aspect-1-1  { aspect-ratio: 1 / 1; }

/* --- Fixed Home button (top-right) --- */
.home-fab {
  position: fixed;
  top: max(12px, var(--safe-top, 0px));
  right: max(12px, var(--safe-right, 0px));
  width: 38px;
  height: 38px;
  display: grid;
  place-items: center;
  border-radius: 999px;
  background: #2f3032;
  color: #fff;
  border: 1px solid #3b3c3f;
  box-shadow: 0 2px 8px rgba(0,0,0,0.25);
  text-decoration: none;
  z-index: 10000;
}

.home-fab:hover { background: #3a3b3e; border-color: #4a4c50; }
.home-fab:active { transform: translateY(1px); }
.home-fab:focus-visible { outline: 2px solid #74c7ec; outline-offset: 2px; }

.home-fab svg { width: 20px; height: 20px; fill: currentColor; }

/* Dark mode keeps contrast */
body.dark-mode .home-fab { background: #2a2b2d; color: #fff; border-color: #35373a; }
body.dark-mode .home-fab:hover { background: #343639; border-color: #43464a; }