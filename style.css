/*
 * Custom styles for Francis’ personal page.
 *
 * The layout and many of the dark‑mode interactions take inspiration
 * from Jeannette Bohg’s personal website and Cassidy Williams’ template.
 */

html, body {
  width: 100%;
  margin: 0;
  padding: 0;
  font-family: "Roboto Mono", monospace;
  background: #fff;
  color: #000;
  /* Ensure the body always covers at least the full viewport height so that the
     background color extends to the bottom of the page.  Without this, short
     pages in dark mode expose the html element's white background at the
     bottom of the viewport. */
  min-height: 100vh;
}

:root {
  --safe-top: env(safe-area-inset-top);
  --safe-right: env(safe-area-inset-right);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
}

/* Always honor the HTML `hidden` attribute, even if later rules set display. */
[hidden] { display: none !important; }

/* Dark mode applies when the <body> element has the class 'dark-mode'. */
body.dark-mode {
  background: #000;
  color: #fff;
}

/* Apply the dark mode background and foreground colours to the <html> element when
   it has the dark-mode class.  This ensures that areas outside of the body (for
   example, when the content is shorter than the viewport height) still have the
   correct dark background instead of reverting to the default white canvas. */
html.dark-mode {
  background: #000;
  color: #fff;
}

/* Universal selection highlight. */
::selection {
  background-color: #eb4888;
  color: #000;
}

button {
  /* Pill shaped toggle buttons inspired by Jeannette Bohg’s original design. */
  display: inline-block;
  min-width: 72px;
  height: 32px;
  padding: 2px 14px;
  border: 2px solid #96979c;
  border-radius: 22px;
  box-sizing: border-box;
  color: #96979c;
  font-size: 0.9rem;
  font-family: inherit;
  background: transparent;
  transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
  cursor: pointer;
}

button:hover {
  /* Subtle hover effect: light grey on light mode, semi‑transparent on dark mode. */
  background: rgba(150, 151, 156, 0.1);
}

/* Highlight the active button.  In light mode, active buttons have a white interior with
   coloured text and border.  In dark mode the interior uses a semi‑transparent tint. */
button.active {
  border-color: #eb4888;
  color: #eb4888;
  background-color: #fff;
}

body.dark-mode button.active {
  background-color: rgba(235, 72, 136, 0.15);
}

/* Dark‑mode adjustments for buttons: more contrast for default state. */
body.dark-mode button {
  border-color: #777;
  color: #aaa;
  background: transparent;
}

body.dark-mode button:hover {
  background: rgba(255, 255, 255, 0.08);
}

.container {
  /* Use padding instead of top margin so that the body's background colour remains visible in dark mode.
     A top margin on the first child can collapse with the body's margin and reveal the html's default
     background (white) as a bar at the top of the page.  By using padding we avoid that collapse. */
  margin: 0 auto;
  padding: calc(50px + var(--safe-top, 0px)) max(5px, var(--safe-right, 0px)) max(5px, var(--safe-bottom, 0px)) max(5px, var(--safe-left, 0px));
  max-width: 800px;
}

@media (max-width: 600px) {
  .container {
    /* Add top padding on small screens as well to prevent margin collapse. */
    padding: calc(40px + var(--safe-top, 0px)) max(20px, var(--safe-right, 0px)) max(20px, var(--safe-bottom, 0px)) max(20px, var(--safe-left, 0px));
  }
}

.header-section {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
}

/* Improve header layout on tablets */
@media (max-width: 800px) {
  .header-section {
    gap: 14px;
  }
  .header-frame {
    max-width: 100%;
  }
  .img-frame {
    margin-left: auto;
    margin-right: auto;
  }
}

.header-frame {
  /* Allow more room for the name and subtitle text */
  max-width: 470px;
}

h1 {
  font-weight: 400;
  margin: 0;
  font-size: clamp(1.8rem, 2.2rem + 0.5vw, 2.6rem);
}

/* Name styling: primary larger, secondary slightly smaller */
.name-primary {
  display: block;
  line-height: 1.1;
}

.name-secondary {
  display: block;
  line-height: 1.1;
  font-size: 0.88em; /* slightly smaller than primary */
  margin-top: 0.15em;
}

/* Typewriter caret for auto-switching name */
.typewriter {
  position: relative;
}
.typewriter::after {
  content: "";
  display: inline-block;
  width: 0.6ch;
  height: 1em;
  margin-left: 0.1ch;
  vertical-align: -0.15em;
  background: currentColor;
  opacity: 0.7;
  animation: caretBlink 1s steps(1, end) infinite;
}

@keyframes caretBlink {
  0%, 50% { opacity: 0.7; }
  51%, 100% { opacity: 0; }
}

@media (prefers-reduced-motion: reduce) {
  .typewriter::after {
    animation: none;
  }
}

h2 {
  color: #96979c;
  font-weight: 300;
  margin: 0.4em 0 0;
  font-size: clamp(1rem, 1rem + 0.2vw, 1.15rem);
}

.img-frame {
  position: relative;
  width: min(260px, 42vw);
  height: min(260px, 42vw);
  margin: 10px 0;
  border-radius: 50%;
  overflow: hidden;
}

.img-frame img {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: auto;
  height: 100%;
}

.links {
  margin: 25px 0;
}

.links a {
  /* Animated underline effect similar to cassidoo.co */
  position: relative;
  display: inline-block;
  margin-right: 16px;
  color: #96979c; /* individual links override this via inline color */
  font-size: 0.9rem;
  text-decoration: none; /* we'll draw our own underline */
  padding-bottom: 2px; /* space for underline bar */
}

.links a::after {
  content: "";
  position: absolute;
  left: 0;
  bottom: -3px;
  height: 4px;
  width: 100%;
  background-color: currentColor; /* match the link color */
  border-radius: 2px;
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 200ms ease-in-out;
}

.links a:hover::after,
.links a:focus-visible::after,
.links a.active::after {
  transform: scaleX(1);
}

/* Reusable animated underline for inline links in content
   Works across multi-line wrapped text */
.animated-link {
  text-decoration: none;
  background-image: linear-gradient(currentColor, currentColor);
  background-repeat: no-repeat;
  background-position: 0 100%;
  background-size: 0% 4px;
  transition: background-size 200ms ease-in-out;
}
.animated-link:hover,
.animated-link:focus-visible,
.animated-link.active {
  background-size: 100% 4px;
}

@media (max-width: 600px) {
  .links {
    text-align: center;
  }
  .links a {
    display: inline-block;
    margin: 6px 10px;
  }
}

/* Toggle button group */
.toggler {
  margin: 25px 0;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center; /* vertically align label with buttons */
}

.toggler button {
  flex: 0 0 auto; /* prevent stretching; keep natural width */
  min-width: 60px;
}

/* Ensure the "Bio:" label aligns with the buttons and has no extra margins */
.toggler p {
  margin: 0;
}

@media (max-width: 600px) {
  .toggler {
    justify-content: center;
  }
}

/* Bio sections hidden by default except the one with .show */
.bio {
  display: none;
  line-height: 1.6;
  font-size: 0.95rem;
}

.bio.show {
  display: block;
}

/* List style for projects */
.bio ul {
  list-style-type: disc;
  padding-left: 20px;
}

.bio li {
  margin-bottom: 6px;
}

/* Research list styling */
.research-intro {
  color: #96979c;
  font-size: 0.9rem;
  margin-bottom: 10px;
}

.research-list {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  list-style: none;
  padding: 0;
  margin: 0;
}

.research-item {
  padding: 6px 12px;
  border: 1px solid #d0d0d0;
  border-radius: 999px;
  background: #fff;
  color: #333;
  font-size: 0.9rem;
  cursor: pointer;
  transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.05s ease;
}

.research-item:hover,
.research-item:focus-visible {
  border-color: #eb4888;
  color: #eb4888;
}

.research-item.selected {
  background: rgba(235, 72, 136, 0.12);
  border-color: #eb4888;
  color: #eb4888;
}

.research-item:active {
  transform: scale(0.98);
}

.research-sep {
  display: block;
  width: 100%;
  margin: 6px 0 0;
  color: #96979c;
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

/* Dark mode for research list */
body.dark-mode .research-item {
  background: #111;
  color: #ddd;
  border-color: #444;
}

body.dark-mode .research-item:hover,
body.dark-mode .research-item:focus-visible {
  color: #eb4888;
  border-color: #eb4888;
}

body.dark-mode .research-item.selected {
  background: rgba(235, 72, 136, 0.18);
  border-color: #eb4888;
  color: #eb4888;
}

/* Table styling for skills */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  font-size: 0.85rem;
}

th, td {
  border: 1px solid #d0d0d0;
  padding: 8px 12px;
  text-align: left;
}

th {
  background-color: #f5f5f5;
  color: #333;
}

/* Dark mode table adjustments */
body.dark-mode th {
  background-color: #222;
  color: #eee;
}
body.dark-mode td,
body.dark-mode th {
  border-color: #444;
}
body.dark-mode table {
  color: #ddd;
}

/* Citation markers appear inline and small.  Apply to any element with the 'citation' class (e.g. <a>, <span>). */
.citation {
  font-size: 0.75rem;
  vertical-align: super;
  text-decoration: none;
  cursor: default;
  color: inherit;
}

.citation:hover {
  text-decoration: underline;
}

/* Dark mode toggler positioning */
.dark-mode-toggler {
  position: fixed;
  top: 10px;
  right: 10px;
}

.dark-mode-toggler input[type="checkbox"] {
  display: none;
}

.dark-mode-toggler input[type="checkbox"] + label::before {
  content: "";
  display: block;
  height: 26px;
  width: 60px;
  background: #fff;
  border: 2px solid #96979c;
  border-radius: 15px;
  position: absolute;
  top: 0;
  left: -65px;
  transition: background 0.4s ease;
}

.dark-mode-toggler input[type="checkbox"] + label::after {
  content: "";
  display: block;
  height: 20px;
  width: 20px;
  background: #96979c;
  border: 2px solid #fff;
  border-radius: 50%;
  position: absolute;
  top: 3px;
  left: -62px;
  transition: left 0.4s ease, background 0.4s ease;
}

.dark-mode-toggler input[type="checkbox"]:checked + label::before {
  background: #000;
  border: 2px solid #fff;
}

.dark-mode-toggler input[type="checkbox"]:checked + label::after {
  left: -28px;
  /* When dark mode is enabled the knob uses the accent color so it remains visible on a dark background. */
  background: #eb4888;
  border: 2px solid #fff;
}

/* Additional styling for dark mode toggle in dark mode: adjust the track and knob colours for better contrast. */
body.dark-mode .dark-mode-toggler input[type="checkbox"] + label::before {
  background: #222;
  border-color: #888;
}

body.dark-mode .dark-mode-toggler input[type="checkbox"] + label::after {
  background: #888;
  border-color: #222;
}

body.dark-mode .dark-mode-toggler input[type="checkbox"]:checked + label::after {
  background: #eb4888;
  border-color: #eb4888;
}

/* Attribution styling */
.attribution {
  margin: 40px auto;
  max-width: 800px;
  font-size: 0.8rem;
  color: #96979c;
  line-height: 1.4;
}

body.dark-mode .attribution {
  color: #777;
}

/* Skills cards horizontal scroller */
.skills-cards {
  display: flex;
  gap: 18px;
  margin-top: 10px;
  overflow-x: auto;
  overflow-y: hidden;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  padding: 6px 6px 16px;
  scroll-padding: 6px;
  border-radius: 14px;
  position: relative;
  background: transparent;
}

.skill-card {
  background: #fff;
  border: 1px solid #eee;
  border-radius: 16px;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.06);
  padding: 22px;
  flex: 0 0 auto;
  width: clamp(260px, 44vw, 360px);
  scroll-snap-align: start;
}

.skill-icon {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: rgba(255, 165, 0, 0.12);
  color: #ff9900;
  display: grid;
  place-items: center;
  font-size: 22px;
  margin-bottom: 12px;
  border: 1px solid rgba(0, 0, 0, 0.04);
}

.skill-title {
  margin: 0 0 6px 0;
  font-size: 1.15rem;
  font-weight: 600;
  color: #111;
}

.skill-desc {
  margin: 0;
  color: #4a4b50;
  font-size: 0.95rem;
  line-height: 1.7;
}

/* Dark mode support for skills cards */
body.dark-mode .skill-card {
  background: #111;
  border-color: #333;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
}

body.dark-mode .skill-title {
  color: #fff;
}

body.dark-mode .skill-desc {
  color: #d0d0d0;
}

body.dark-mode .skill-icon {
  background: rgba(255, 165, 0, 0.2);
  color: #ffb84d;
  border-color: rgba(255, 255, 255, 0.08);
}

/* Subtle horizontal scrollbar styling (WebKit) */
.skills-cards::-webkit-scrollbar {
  height: 8px;
}

.skills-cards::-webkit-scrollbar-track {
  background: transparent;
  border-radius: 999px;
}

.skills-cards::-webkit-scrollbar-thumb {
  background: rgba(150, 150, 155, 0.3);
  border-radius: 999px;
}

body.dark-mode .skills-cards::-webkit-scrollbar-track {
  background: transparent;
}

body.dark-mode .skills-cards::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.28);
}

/* Edge fade masks for slide-in/out feeling */
.skills-cards::before,
.skills-cards::after {
  content: "";
  position: sticky;
  top: 0;
  width: 56px;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

.skills-cards::before {
  left: 0;
  background: linear-gradient(
    to right,
    #fff 0%,
    rgba(255, 255, 255, 0.85) 35%,
    rgba(255, 255, 255, 0) 100%
  );
}

.skills-cards::after {
  right: 0;
  background: linear-gradient(
    to left,
    #fff 0%,
    rgba(255, 255, 255, 0.85) 35%,
    rgba(255, 255, 255, 0) 100%
  );
}

body.dark-mode .skills-cards::before {
  background: linear-gradient(
    to right,
    #000 0%,
    rgba(0, 0, 0, 0.75) 35%,
    rgba(0, 0, 0, 0) 100%
  );
}

body.dark-mode .skills-cards::after {
  background: linear-gradient(
    to left,
    #000 0%,
    rgba(0, 0, 0, 0.75) 35%,
    rgba(0, 0, 0, 0) 100%
  );
}

/* Research section (modeled after Jon Barron’s compact card list) */
.research-section {
  margin-top: 60px;
  padding-top: 20px;
  border-top: 2px solid #eaeaea; /* separate from previous area */
}

.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.section-title {
  margin: 0 0 6px 0;
  font-size: 1.6rem;
  font-weight: 500;
  color: #000; /* ensure pure black in light mode */
}

.section-subtitle {
  margin: 0 0 18px 0;
  color: #96979c;
  font-size: 0.95rem;
}

.research-lists {
  display: grid;
  grid-template-columns: 1fr;
  gap: 28px; /* vertical space between cards */
}

/* Make inner lists not generate their own boxes so items participate in the same grid */
.research-lists > .papers,
.research-lists > .projects {
  display: contents;
}

/* No extra media-rule needed because the unified grid is 1 column */

.paper {
  display: grid;
  grid-template-columns: 160px 1fr;
  gap: 16px;
  align-items: start;
  padding: 14px;
  border: 1px solid #eee;
  border-radius: 14px;
  background: #fff;
}

.paper-thumb {
  width: 160px;
  height: 100px;
  border-radius: 10px;
  overflow: hidden;
  background: #f6f6f6;
  display: grid;
  place-items: center;
  color: #999;
  font-size: 0.85rem;
}

/* Stack research card thumbnail above text on narrow screens */
@media (max-width: 560px) {
  .paper {
    grid-template-columns: 1fr;
  }
  .paper-thumb {
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;
  }
}

.thumb-placeholder {
  padding: 6px 8px;
}

.paper-title {
  margin: 0 0 4px 0;
  font-size: 1.05rem;
}

.paper-authors,
.paper-venue,
.paper-links,
.paper-abstract {
  margin: 4px 0;
  color: #4a4b50;
}

.paper-links a {
  color: #0099dc;
  text-decoration: none;
}

.paper-links a:hover {
  text-decoration: underline;
}

/* Dark mode for research section */
body.dark-mode .paper {
  background: #111;
  border-color: #333;
}

/* In dark mode, make section titles white for proper contrast */
body.dark-mode .section-title {
  color: #fff;
}

body.dark-mode .paper-thumb {
  background: #1a1a1a;
  color: #aaa;
}

body.dark-mode .paper-authors,
body.dark-mode .paper-venue,
body.dark-mode .paper-links,
body.dark-mode .paper-abstract {
  color: #d0d0d0;
}

/* Research filter menu (years/tags/type) inspired by cassidoo.co/blog */
.research-menu {
  margin: 20px 0 14px;
  padding: 6px 8px;
  background: #f8f9fb; /* subtle panel background for separation */
  border: 1px solid #eee;
  border-radius: 10px;
}

/* Simple row for the filter enable switch */
.filter-toggle {
  margin: 0 0 6px;
  color: #96979c;
  font-size: 0.9rem;
}

/* Switch control */
.switch {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  user-select: none;
}

.switch input[type="checkbox"] {
  display: none;
}

.switch .switch-ui {
  position: relative;
  display: inline-block;
  width: 34px;
  height: 18px;
  background: #e9e9ee;
  border: 2px solid #c4c5cb;
  border-radius: 999px;
  transition: background-color 160ms ease, border-color 160ms ease;
}

.switch .switch-ui::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 2px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: #bdbec4;
  transform: translate(0, -50%);
  transition: transform 180ms cubic-bezier(0.2, 0, 0, 1), background-color 160ms ease;
}

.switch input[type="checkbox"]:checked + .switch-ui {
  background: rgba(235, 72, 136, 0.28);
  border-color: #eb4888;
}

.switch input[type="checkbox"]:checked + .switch-ui::after {
  transform: translate(16px, -50%);
  background: #eb4888;
}

.switch .switch-text {
  color: #96979c;
}

body.dark-mode .switch .switch-ui {
  background: #222;
  border-color: #555;
}

body.dark-mode .switch .switch-ui::after {
  background: #777;
}

body.dark-mode .switch input[type="checkbox"]:checked + .switch-ui {
  background: #eb4888;
  border-color: #eb4888;
}

body.dark-mode .switch input[type="checkbox"]:checked + .switch-ui::after {
  background: #111;
}

.switch .switch-ui:focus-visible {
  outline: 2px solid #0099dc;
  outline-offset: 2px;
}

@media (max-width: 600px) {
  .section-header {
    align-items: flex-end;
  }
  .filter-toggle {
    margin-bottom: 10px;
  }
}

.menu-divider {
  border: none;
  border-top: 2px solid #e6e6e6;
  margin: 6px 0;
}

.menu-row {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  line-height: 0.2; /* tighter row spacing */
}

.menu-item,
.menu-row a {
  position: relative;
  color: #111;
  text-decoration: none;
  font-size: 0.8rem; /* smaller text */
  line-height: 0.2; /* tighter line height on items */
}

.menu-item::after,
.menu-row a::after {
  content: "";
  position: absolute;
  left: 0;
  bottom: -2px;
  height: 2px;
  width: 100%;
  background: currentColor;
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 180ms ease-in-out;
}

.menu-item:hover::after,
.menu-item.active::after,
.menu-row a:hover::after,
.menu-row a.active::after {
  transform: scaleX(1);
}

.menu-item {
  background: transparent;
  border: none;
  padding: 0;
  cursor: pointer;
}

/* Color accents similar to Cassidy's tags: rotate colors with nth-child */
.menu-row.years .menu-item:nth-child(4n+1),
.menu-row.tags .menu-item:nth-child(4n+1),
.menu-row a:nth-child(4n+1) { color: #eac15a; }

.menu-row.years .menu-item:nth-child(4n+2),
.menu-row.tags .menu-item:nth-child(4n+2),
.menu-row a:nth-child(4n+2) { color: #74c7ec; }

.menu-row.years .menu-item:nth-child(4n+3),
.menu-row.tags .menu-item:nth-child(4n+3),
.menu-row a:nth-child(4n+3) { color: #f08ca0; }

.menu-row.years .menu-item:nth-child(4n+4),
.menu-row.tags .menu-item:nth-child(4n+4),
.menu-row a:nth-child(4n+4) { color: #66d19e; }

/* Dark mode tweaks */
body.dark-mode .menu-divider { border-top-color: #333; }
body.dark-mode .menu-item, body.dark-mode .menu-row a { color: #ddd; }
body.dark-mode .research-menu {
  background: #0f0f10;
  border-color: #222;
}

/* Snackbar (bottom slide-up card) */
.snackbar {
  position: fixed;
  left: 50%;
  bottom: -80px; /* hidden below viewport initially */
  transform: translateX(-50%);
  background: #111;
  color: #fff;
  padding: 12px 18px;
  border-radius: 10px;
  border: 1px solid #333;
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  transition: bottom 300ms ease, opacity 300ms ease;
  opacity: 0;
  z-index: 9999;
}

body.dark-mode .snackbar {
  background: #222;
  border-color: #555;
  color: #fff;
}

.snackbar.show {
  bottom: 24px; /* visible position */
  opacity: 1;
}